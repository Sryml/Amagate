# Amagate Documentation

## 📖 安装

Blender 版本：4.3.0 或以上

从菜单栏中选择`编辑 -> 偏好设置 -> 获取扩展`，  
然后点击右上角`从磁盘安装`并选择下载好的扩展 zip 文件。

初次安装会自动安装所需的 Python 包，大约 41MB。

## 🌠 功能

- [关卡编辑器 (L3D)](#关卡编辑器-l3d)
- Blade 坐标转换
- 立方体贴图转换

## 关卡编辑器 (L3D)

### ✨ 优势

- 使用自定义二进制协议与游戏客户端进行通信（例如同步摄像机移动，加载地图等）
- 可自由编辑的面（例如制作拱形的墙壁）
- 移动扇区不会像 LED 那样丢失斜坡状态
- 可在扇区任意平面上分割任意形状的子纹理（LED 只能在墙壁上垂直分割）
- 纹理下拉列表有筛选和预览功能
- 单独设置纹理的 X/Y 轴缩放
- 实时切换天空纹理
- 实时的 3D 预览与编辑

### 🎯 标记对象

- `Player`表示导出地图时的玩家位置

### HUD 信息

1. 选中的扇区
2. 是否同胚于二维球面  
   如果选中的扇区中存在混合类型，则显示为`*`
3. 是否为凸多面体  
   如果选中的扇区中存在混合类型，则显示为`*`

### 🌟 L3D 功能

- 场景
  - 大气管理
  - 外部光管理
  - 纹理管理
  - 天空纹理的设置与下载
  - 默认扇区属性设置
  - 视锥裁剪
- 扇区
  - 陡峭检查与设置
  - 大气分配
  - 预设纹理分配
  - 单独设置纹理的 X/Y 轴缩放
  - 外部光分配
  - 环境光设置
  - 平面光设置
  - 灯泡光管理
  - 组分配
  -
  - 自动有限融并
  - 复制处理
  - 分离处理
  - 合并处理
  - 删除处理
- 工具
  - 多线段路径创建
  - 虚拟扇区创建与导出
  - 转换为扇区
  - 分离凸部分
  - 连接扇区
  - 断开连接扇区
  - 将选中扇区设为默认
  - 编译地图
  - 导入地图
- 服务器
  - 加载任意关卡
  - 重载当前关卡
  - 对齐摄像机到客户端
  - 实时同步 blender 摄像机到客户端
  - 移动客户端玩家到摄像机位置
- 其它
  - 编译地图只会编译可见的凸扇区

### ⚠️ 注意事项

- **体积雾**  
  黑色雾无法显示灯光
- **凹多面体**  
  不要一次性制作复杂凹扇区，应该制作多个凸扇区，然后连接它们
- **非均匀缩放问题**  
  如果扇区连接或其它扇区操作失败，尝试应用缩放变换`(Ctrl+A -> Scale)`
- **灯光模拟偏差**  
  出现在灯泡光的照射范围或多重光照的亮度颜色
- **天空纹理**  
  天空纹理必须独占一个扇区平面
- **防止自动融并**  
  如果想要为平面上的相同纹理设置不同的位置/缩放/角度，需要将其标记为锐边
- **复制处理**  
  扇区的复制方式应该使用 `Shift+D/Alt+D`，而不是 `Ctrl+C`
- **扇区连接**  
  如果扇区连接失败，尝试重新调整下位置，确保面与面紧密贴合
- **分离凸部分**  
  复杂凹多面体无法分离，只能手动分离  
  在分离前需要先执行凹面拆分，否则分离出的扇区会存在凹多面体  
  跨面分割情况不太可靠，建议关闭自动连接，手动调整分割后的扇区再执行连接

## 📝 待办事项

- 扇区 Prefab（门，窗户，房屋，台阶等）
- 放置 BOD 物品
